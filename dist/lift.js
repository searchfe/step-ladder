!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t=t||self).lift=t.lift||{},t.lift.js=n())}(this,function(){"use strict";var o=function(t,n){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(t,n)};var n,t,e,i=(r.prototype.on=function(t,n){this.eventMap[t]||(this.eventMap[t]=[]),this.eventMap[t].push(n)},r.prototype.emit=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(this.eventMap[t])for(var e=0,i=this.eventMap[t];e<i.length;e++)i[e].apply(i,n)},r.prototype.off=function(t,n){var o;t?t&&!n?this.eventMap[t]=[]:n&&this.eventMap[t]&&-1<(o=this.eventMap[t].indexOf(n))&&this.eventMap[t].splice(o,1):this.eventMap={}},r.prototype.one=function(o,e){var i,r=this;this.on(o,i=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.apply(void 0,t),r.off(o,i)})},r);function r(){this.eventMap={}}function p(){this.constructor=t}function f(){var t=n.call(this)||this;return t.index=-1,t.pool=[],t.finalFn=function(){},t}return o(t=f,e=n=i),t.prototype=null===e?Object.create(e):(p.prototype=e.prototype,new p),f.prototype.setConfig=function(t){this.config=t()},f.prototype.up=function(o){var e=this;return function(t){void 0===t&&(t=1);var n=o-t;n<0?e.pool[0]():e.pool[n]()}},f.prototype.next=function(e){var i=this;return function(t,n){void 0===t&&(t=1);var o=e+t;i.pool.length-1<o?i.end(n):i.pool[o](n)}},f.prototype.end=function(t){this.finalFn(t)},f.prototype.use=function(t){var n=++this.index,o={up:this.up(n),next:this.next(n),end:this.end,config:this.config};this.pool.push(t.bind(o))},f.prototype.useSome=function(h){var t,c;h&&0!==h.length&&(t=++this.index,c={next:this.next(t),config:this.config},this.pool.push(function(t){if(t&&0!==t.length)for(var n=t.length,o=0,e=[],i={},r=0;r<t.length;r++)for(var p=t[r],f=0;f<h.length;f++){var s={order:r,config:c.config,cb:function(t){void 0===i[""+this.order]?i[""+this.order]=1:i[""+this.order]++,t&&!e[this.order]?(e[this.order]=t,o++):i[""+this.order]!==h.length||e[this.order]||o++,o===n&&c.next(1,e)}};h[f].bind(s)(p)}else c.next(1,[])}))},f.prototype.useEvery=function(p){var t,f;p&&0!==p.length&&(t=++this.index,f={next:this.next(t),config:this.config},this.pool.push(function(t){for(var n=p.length,o=0,e=[],i=0;i<p.length;i++){var r={fnIndex:i,config:f.config,cb:function(t){e[this.fnIndex]=t,++o===n&&f.next(1,e)}};p[i].bind(r)(t)}}))},f.prototype.invoke=function(t){t&&(this.finalFn=t,0<this.pool.length?this.pool[0]():this.finalFn())},f.prototype.start=function(t){void 0===t&&(t=0),0<this.pool.length&&this.pool[t]&&this.pool[t]()},f});
